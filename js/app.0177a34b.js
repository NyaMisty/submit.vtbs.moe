(function(t){function e(e){for(var r,s,c=e[0],o=e[1],u=e[2],d=0,f=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);l&&l(e);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,c=1;c<n.length;c++){var o=n[c];0!==a[o]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},i=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=o;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"03f4":function(t,e,n){n("4160"),n("d81d"),n("b0c0"),n("c1f9"),n("159b"),t.exports=function(t){var e=t.vtbs,n=[],r=Object.fromEntries(e.map((function(t){return[t.uuid,t]})));return e.forEach((function(t){var e=t.group,a=t.name;e&&!r[e]&&n.push("社团不存在, no group ".concat(a[a.default]))})),n}},"0640":function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return v}));n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("96cf");var r,a=n("1da1"),i=n("2909"),s=n("faa1"),c=n.n(s),o=!self.window,u=[],l=new Map,d=new Map,f=function(){return String(Math.random())},p=new c.a,m=function(t){if(r)throw new Error("Worker??");r=t,t.addEventListener("message",(function(t){var e=t.data,n=e.key,r=e.data;l.get(n)(r),l.delete(n),d.delete(n),p.emit("running",Object(i["a"])(d.entries()))}))};o&&self.addEventListener("message",function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.data,r=n.fNum,a=n.params,s=n.key,t.t0=self,t.t1=s,t.next=5,u[r].apply(u,Object(i["a"])(a));case 5:t.t2=t.sent,t.t3={key:t.t1,data:t.t2},t.t0.postMessage.call(t.t0,t.t3);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var v=function(t){var e=u.length;u.push(t);var n=function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r?new Promise((function(n){if(r){var s=f();l.set(s,n),d.set(s,t.displayName),p.emit("c",Object(i["a"])(d.entries())),r.postMessage({fNum:e,params:a,key:s})}})):t.apply(void 0,a)};return n.registerName=function(e){t.displayName=e},n}},"0b01":function(t,e,n){},1:function(t,e){},2:function(t,e){},"263b":function(t,e,n){},3164:function(t,e,n){},3955:function(t,e,n){n("4de4"),n("5db7"),n("d81d"),n("73d9"),t.exports=function(t){var e=t.vtbs;return e.flatMap((function(t){var e=t.accounts;return e})).map((function(t){var e=t.id;return"string"!==typeof e&&"id is not string, ".concat(e)})).filter(Boolean)}},"3e55":function(t,e,n){n("5db7"),n("73d9");var r=n("03f4"),a=n("9309"),i=n("b90b"),s=n("3955"),c=n("c754"),o=n("b74b"),u=[r,a,s,i,c,o];t.exports=function(t,e){return u.flatMap((function(n){return n(t,e)}))}},"4c53":function(t,e,n){t.exports=function(){return new Worker(n.p+"0ac84bd8085510b34c9e.worker.js")}},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",[n("section",{staticClass:"hero is-success is-fullheight is-bold"},[t._m(0),n("div",{staticClass:"hero-foot"},[t.fsLoaded?n("nav",{staticClass:"tabs"},[n("div",{staticClass:"container"},[n("ul",[n("router-link",{staticClass:"link",attrs:{tag:"li",to:"/"}},[n("a",{staticClass:"aLink"},[t._v("Panel")])]),n("router-link",{staticClass:"link",attrs:{tag:"li",to:"/edit"}},[n("a",{staticClass:"aLink"},[t._v("新建")])]),n("router-link",{staticClass:"link",attrs:{tag:"li",to:"/submit"}},[n("a",{staticClass:"aLink"},[t._v("提交!("+t._s(t.diff.length)+")")])]),n("router-link",{staticClass:"link",attrs:{tag:"li",to:"/workspace"}},[n("a",{staticClass:"aLink"},[t._v("工作区存档("+t._s(t.workspaceList.length)+")")])]),n("router-link",{staticClass:"link",attrs:{tag:"li",to:"/login"}},[n("a",{staticClass:"aLink"},[t._v("登录"+t._s(t.currentState))])])],1)])]):n("div",{staticClass:"container"},[t._v(" Loading... ")])])]),t.fsLoaded?n("router-view"):t._e()],1),n("transition-group",{attrs:{name:"worker-list"}},t._l(t.running,(function(e,r){var a=e[0],i=e[1];return n("span",{key:"worker_"+a,staticClass:"tag is-rounded running",style:{bottom:30*r+"px"}},[t._v(t._s(i))])})),0)],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hero-body"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"title"},[t._v(" submit.vtbs.moe ")]),n("h2",{staticClass:"subtitle"},[t._v(" 你好呀 ")])])])}],s=n("5530"),c=n("2f62"),o=n("0640"),u=(n("b0c0"),n("d3b7"),n("25f0"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),l="localhost"===location.hostname,d=l?"23b965c70f0005df2d72":"0dcef2f6e6221b70214f",f=l?"505afa12c4fda8164fb56e9f2b607f3e62f62de0":"e1d64c4471a750145616d38b22b063a380cd9a3a",p=function(){var t=new URL("https://github.com/login/oauth/authorize");return t.searchParams.set("client_id",d),l&&t.searchParams.set("redirect_uri","http://localhost:8080/login"),t.searchParams.set("scope","public_repo"),t.toString()},m=function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({code:e,client_secret:f,client_id:d})});case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,a=r.access_token,t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,i,s,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.github.com/user",{headers:{Authorization:"token ".concat(e)}});case 2:return n=t.sent,t.next=5,n.json();case 5:return r=t.sent,a=r.login,i=r.name,s=r.email,c=r.avatar_url,o=r.html_url,t.abrupt("return",{login:a,name:i,email:s,avatar:c,url:o});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),b=function(t){t?localStorage.submitToken=t:localStorage.removeItem("submitToken")},h=function(){return localStorage.submitToken},g=Object(c["a"])("login"),j=g.mapGetters,_=g.mapActions,O={data:function(){return{running:[]}},mounted:function(){var t=this;this.loadWorkspaceList(),o["b"].on("running",(function(e){t.running=e})),this.fsLoaded||this.loadFs();var e=h();e&&this.updateToken(e)},computed:Object(s["a"])({},Object(c["d"])(["fsLoaded","workspaceList","diff"]),{},j(["currentState"])),methods:Object(s["a"])({},Object(c["c"])(["loadFs","loadWorkspaceList"]),{},_(["updateToken"]))},k=O,x=(n("f3bb"),n("2877")),w=Object(x["a"])(k,a,i,!1,null,"5a852a3c",null),C=w.exports,y=n("8c4f"),L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("list")],1)},R=[],N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"index"},[n("div",{staticClass:"control search",class:{"is-loading":t.searching}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"input",attrs:{type:"text",placeholder:"搜索"},domProps:{value:t.searchInput},on:{input:function(e){e.target.composing||(t.searchInput=e.target.value)}}})]),n("div",{staticClass:"indexContainer",style:{height:t.totalHeight+"px"}},[t._l(t.renderedList,(function(t,e){var r=t.i;void 0===r&&(r=0);var a=t.file;return n("vtb",{key:"vtb_"+e,attrs:{i:r,file:a,n:e}})})),t._l(t.detectors,(function(t){var e=t.height,r=t.top,a=t.i,i=t.ref;return n("div",{key:i,ref:"detectors",refInFor:!0,staticClass:"detectors",style:{height:e+"px",top:r+"px"},attrs:{i:a}})}))],2),t.displayFileList.length?t._e():[n("br"),n("hr"),n("p",[t._v("无结果...")])]],2)},E=[],S=(n("cb29"),n("4de4"),n("4160"),n("d81d"),n("a9e3"),n("ac1f"),n("841c"),n("1276"),n("159b"),n("2909")),M=(n("4fad"),n("3835")),$=n("4c53"),A=n.n($),F=n("f89f");Object(o["a"])(new A.a),Object.entries(F).map((function(t){var e=Object(M["a"])(t,2),n=e[0],r=e[1];return r.registerName(n)}));var I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vtb",style:{top:t.i*t.height+"px"},attrs:{n:t.n}},[n("br"),n("hr"),n("div",{staticClass:"columns is-mobile"},[n("div",{staticClass:"column name"},[n("h1",{staticClass:"title is-4 name"},[t._v(t._s(t.name))]),n("h2",{staticClass:"subtitle is-4 name"},[t._v(t._s(t.file))])]),n("div",{staticClass:"is-divider-vertical"}),n("div",{staticClass:"column"},[n("span",{staticClass:"tag is-light is-medium",class:{"is-link":"group"===t.type,"is-primary":"vtuber"===t.type}},[t._v(t._s(t.type))])]),n("div",{staticClass:"is-divider-vertical"}),n("div",{staticClass:"column"},[n("div",{staticClass:"buttons"},[n("router-link",{staticClass:"button is-info is-small",attrs:{tag:"button",to:"edit/"+t.file}},[t._v("编辑")]),n("button",{staticClass:"button is-danger is-small",on:{click:t.remove}},[t._v("删除")])],1)])])])},P=[],T=(n("99af"),n("0481"),n("4069"),n("4ec9"),n("07ac"),n("faa1")),W=n.n(T),z=110,J=new W.a,D=new Map,B=function(t){if(!D.has(t)){var e=new Promise((function(e){return J.once(t,e)}));D.set(t,e),e.then((function(){D.delete(t)}))}return D.get(t)},G={props:["i","file","n"],data:function(){return{height:z,json:{},currentFile:void 0}},computed:{name:function(){return[].concat(Object(S["a"])(Object.values(this.json.name||{})),["loading..."]).flat()[0]},type:function(){return this.json.type||"vtuber"}},methods:Object(s["a"])({},Object(c["c"])(["loadFileList"]),{remove:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["deleteVtb"])(t.file);case 2:return e.next=4,t.loadFileList();case 4:case"end":return e.stop()}}),e)})))()}}),watch:{file:{immediate:!0,handler:function(t,e){var n=this;return Object(u["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t!==n.currentFile&&(n.json={}),r.next=3,B(String(n.n));case 3:if(t!==n.file){r.next=9;break}if(!t||t===e){r.next=9;break}return r.next=7,Object(F["getVtbJson"])(t);case 7:a=r.sent,t===n.file&&(n.json=a,n.currentFile=t);case 9:case"end":return r.stop()}}),r)})))()}}}},U=G,V=(n("7284"),Object(x["a"])(U,I,P,!1,null,"1e94bd88",null)),H=V.exports,Q=150,Z=0,q={data:function(){return{height:z,renderTop:0,lastIntersect:0,renderedList:Array(Q).fill({}),observer:void 0,intersectionObserver:void 0,searchInput:"",searchResult:void 0,searching:!1}},created:function(){var t=this;this.observer=new IntersectionObserver((function(t){return t.forEach((function(t){var e=t.isIntersecting,n=t.target;if(e){var r=n.getAttribute("n");J.emit(r),Z=Number(r)}}))}),{root:this.$refs.container,thresholds:[0],rootMargin:"80px 0px 20px 0px"}),this.intersectionObserver=new IntersectionObserver((function(e){return e.forEach((function(e){var n=e.isIntersecting,r=e.target;if(n){var a=Number(r.getAttribute("i"));t.lastIntersect=a}}))}),{root:this.$refs.container,thresholds:[0]})},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.loadFileList();case 2:return e.next=4,t.$nextTick();case 4:n=document.getElementsByClassName("vtb"),Array(n.length).fill().map((function(t,e){return n[e]})).forEach((function(e){return t.observer.observe(e)}));case 6:case"end":return e.stop()}}),e)})))()},methods:Object(s["a"])({render:function(t,e){var n=this;Array(e).fill().map((function(e,n){return n+t})).forEach((function(t){var e=t%Q,r=n.displayFileList[t];n.renderedList[e]=r?{i:t,file:r}:{i:-10}})),this.renderedList=Object(S["a"])(this.renderedList)},search:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.toLowerCase().split(" ").filter(Boolean),!r.length){n.next=9;break}return e.searching=!0,n.next=5,Object(F["searchList"])(r);case 5:a=n.sent,t===e.searchInput&&(e.searchResult=a,e.searching=!1),n.next=11;break;case 9:e.searching=!1,e.searchResult=void 0;case 11:case"end":return n.stop()}}),n)})))()}},Object(c["c"])(["loadFileList"])),watch:{detectors:function(t){var e=arguments,n=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.length>1&&void 0!==e[1]?e[1]:[],t.next=3,n.$nextTick();case 3:n.$refs.detectors&&n.$refs.detectors.forEach((function(t){return n.intersectionObserver.observe(t)}));case 4:case"end":return t.stop()}}),t)})))()},searchInput:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.search(t);case 1:case"end":return n.stop()}}),n)})))()},fileList:function(){this.searchInput&&this.search(this.searchInput)},displayFileList:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.render(t.renderTop,Q),e.next=3,t.$nextTick();case 3:Array(15).fill(Math.max(0,Z+Q-9)).map((function(t,e){return(e+t)%Q})).map(String).forEach((function(t){return J.emit(t)}));case 4:case"end":return e.stop()}}),e)})))()},renderTop:function(t,e){if(t>e){var n=Math.max(t,e+Q),r=Math.min(t+Q,this.displayFileList.length);if(n<r){var a=r-n;this.render(n,a)}}else if(e>t){var i=Math.min(e,t+Q),s=i-t;this.render(t,s)}},lastIntersect:function(){var t=this.lastIntersect;this.renderTop=Math.max(0,t-Q/3)}},beforeDestroy:function(){this.observer.disconnect(),this.intersectionObserver.disconnect()},components:{vtb:H},computed:Object(s["a"])({},Object(c["d"])(["fileList"]),{displayFileList:function(){return this.searchResult||this.fileList},totalHeight:function(){return this.displayFileList.length*this.height},detectors:function(){var t=this,e=Math.round(this.displayFileList.length/Q*3)+1,n=this.totalHeight/e;return Array(e).fill().map((function(r,a){return{ref:"detector_".concat(a),height:n,top:a*n,i:Math.round(t.displayFileList.length/e*a)}}))}})},K=q,Y=(n("adf3"),Object(x["a"])(K,N,E,!1,null,"28dbbbd7",null)),X=Y.exports,tt={components:{list:X}},et=tt,nt=Object(x["a"])(et,L,R,!1,null,null,null),rt=nt.exports,at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("br"),n("diff"),n("hr"),n("test"),n("hr"),n("serialize"),n("hr"),n("issue"),n("br")],1)},it=[],st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",{staticClass:"title"},[t._v("改变")]),n("h2",{staticClass:"subtitle"},[t._v("Difference ("+t._s(t.diff.length)+")")]),t._l(t.diff,(function(t){var e=t[0],r=t[1];return n("change",{key:"diff_"+e,attrs:{file:e,status:r}})}))],2)},ct=[],ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{class:{"has-text-danger":"remove"===t.status,"has-text-success":"add"===t.status,"has-text-warning":"update"===t.status}},[t._v(t._s(t.file)+" "),n("button",{staticClass:"button is-small is-text",on:{click:t.reset}},[t._v("撤销")])])])},ut=[],lt={props:["status","file"],methods:Object(s["a"])({},Object(c["c"])(["loadFileList"]),{reset:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["resetVtb"])(t.file);case 2:return e.next=4,t.loadFileList();case 4:case"end":return e.stop()}}),e)})))()}})},dt=lt,ft=(n("8501"),Object(x["a"])(dt,ot,ut,!1,null,"005d5cfb",null)),pt=ft.exports,mt={computed:Object(c["d"])(["diff"]),components:{change:pt}},vt=mt,bt=Object(x["a"])(vt,st,ct,!1,null,null,null),ht=bt.exports,gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",{staticClass:"title"},[t._v("序列化")]),n("h2",{staticClass:"subtitle"},[t._v("Serialize")]),n("div",{staticClass:"table-container"},[n("table",{staticClass:"table is-striped is-hoverable is-fullwidth"},[t._m(0),n("tbody",t._l(t.code,(function(e){var r=e[0],a=e[1],i=e[2];return void 0===i&&(i=""),n("tr",{key:"s_"+a},[n("td",[t._v(t._s(r))]),n("td",[t._v(t._s(a))]),n("td",[i?n("code",[t._v(t._s(i))]):t._e()])])})),0)])])])},jt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("Command")]),n("th",[t._v("File")]),n("th",[t._v("content")])])])}],_t=Object(c["a"])("login"),Ot=_t.mapGetters,kt={data:function(){return{code:[["loading..."]]}},watch:{command:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["serializeDiff"])(t.command);case 2:t.code=e.sent;case 3:case"end":return e.stop()}}),e)})))()},diff:{immediate:!0,handler:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["serializeDiff"])(t.command);case 2:t.code=e.sent;case 3:case"end":return e.stop()}}),e)})))()}}},computed:Object(s["a"])({},Object(c["d"])(["diff"]),{},Ot(["command"]))},xt=kt,wt=(n("dd9f"),Object(x["a"])(xt,gt,jt,!1,null,"ad7d5b94",null)),Ct=wt.exports,yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",{staticClass:"title"},[t._v("发布")]),n("h2",{staticClass:"subtitle"},[t._v("Issue")]),t.diffLength&&t.diffLength>0?[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"textarea",attrs:{placeholder:"附加信息"},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}}),n("br"),n("code",[t._v(t._s(t.issue))]),n("br"),n("label",{staticClass:"checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.githubCommit,expression:"githubCommit"}],attrs:{type:"checkbox",disabled:!t.username},domProps:{checked:Array.isArray(t.githubCommit)?t._i(t.githubCommit,null)>-1:t.githubCommit},on:{change:function(e){var n=t.githubCommit,r=e.target,a=!!r.checked;if(Array.isArray(n)){var i=null,s=t._i(n,i);r.checked?s<0&&(t.githubCommit=n.concat([i])):s>-1&&(t.githubCommit=n.slice(0,s).concat(n.slice(s+1)))}else t.githubCommit=a}}}),t._v(" 以我的GitHub身份Commit "),t.username?t._e():[t._v("(请登陆)")]],2),n("hr"),t.url?t._e():n("button",{staticClass:"button is-link is-light",class:{"is-loading":t.urlLoading},on:{click:t.submit}},[t._v("发布")]),t.url?n("a",{attrs:{href:t.url,target:"_blank"}},[t._v(t._s(t.url))]):t._e()]:t._e(),void 0===t.diffLength?n("span",[t._v(" loading... ")]):t._e(),0===t.diffLength?n("span",[t._v(" 无修改 ")]):t._e()],2)},Lt=[],Rt=Object(c["a"])("login"),Nt=Rt.mapState,Et=Rt.mapMutations,St=Rt.mapGetters,Mt={data:function(){return{diffLength:void 0,input:"",issue:"",url:void 0,urlLoading:!1}},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["diff"])();case 2:t.diffLength=e.sent.length;case 3:case"end":return e.stop()}}),e)})))()},computed:Object(s["a"])({},Object(c["d"])(["diff"]),{},Nt(["commit","username","token"]),{},St(["command"]),{githubCommit:{get:function(){return this.username&&this.commit},set:function(t){this.setCommit(t)}}}),watch:{diff:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["diff"])();case 2:return t.diffLength=e.sent.length,e.next=5,t.updateIssue();case 5:case"end":return e.stop()}}),e)})))()},command:function(){this.updateIssue()},input:{immediate:!0,handler:function(){this.updateIssue()}}},methods:Object(s["a"])({},Et(["setCommit"]),{submit:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.urlLoading=!0,n=[t.input,t.command],t.username&&n.push(t.token),e.next=5,F["submitDiff"].apply(void 0,n);case 5:t.url=e.sent;case 6:case"end":return e.stop()}}),e)})))()},updateIssue:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.input,e.next=3,Object(F["makeIssue"])(n,t.command);case 3:r=e.sent,t.input===n&&(t.issue=r);case 5:case"end":return e.stop()}}),e)})))()}})},$t=Mt,At=(n("a8cf"),Object(x["a"])($t,yt,Lt,!1,null,"2e350816",null)),Ft=At.exports,It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",{staticClass:"title"},[t._v("测试")]),t.loading?n("h2",{staticClass:"subtitle"},[t._v("少女祈祷中...")]):[n("h2",{staticClass:"subtitle"},[t._v("Error: "+t._s(t.errors.length))]),t._l(t.errors,(function(e,r){return n("p",{key:"error_"+r,staticClass:"has-text-danger"},[t._v(t._s(e))])}))]],2)},Pt=[],Tt={data:function(){return{errors:[],loading:!0}},watch:{diff:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,Object(F["test"])();case 3:t.errors=e.sent,t.loading=!1;case 5:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(F["test"])();case 2:t.errors=e.sent,t.loading=!1;case 4:case"end":return e.stop()}}),e)})))()},computed:Object(c["d"])(["diff"])},Wt=Tt,zt=Object(x["a"])(Wt,It,Pt,!1,null,null,null),Jt=zt.exports,Dt={components:{diff:ht,serialize:Ct,issue:Ft,test:Jt}},Bt=Dt,Gt=Object(x["a"])(Bt,at,it,!1,null,null,null),Ut=Gt.exports,Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("br"),n("div",{staticClass:"field is-horizontal"},[t._m(0),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field has-addons"},[n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editing.fileName,expression:"editing.fileName"}],staticClass:"input",attrs:{type:"text",placeholder:"文件名"},domProps:{value:t.editing.fileName},on:{input:function(e){e.target.composing||t.$set(t.editing,"fileName",e.target.value)}}})]),t._m(1)])])]),n("hr"),t._l(t.editing.names,(function(e,r){return n("div",{key:"name_"+r,staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label is-normal"},[r?t._e():n("label",{staticClass:"label"},[t._v("名字")]),r?t._e():n("p",{staticClass:"help"},[t._v("语言可以是 cn, en, jp 之类的")])]),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field has-addons"},[n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editing.names[r][0],expression:"editing.names[n][0]"}],staticClass:"input",attrs:{type:"text",placeholder:"语言"},domProps:{value:t.editing.names[r][0]},on:{input:function(e){e.target.composing||t.$set(t.editing.names[r],0,e.target.value)}}})]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editing.names[r][1],expression:"editing.names[n][1]"}],staticClass:"input",attrs:{type:"text",placeholder:"名字"},domProps:{value:t.editing.names[r][1]},on:{input:function(e){e.target.composing||t.$set(t.editing.names[r],1,e.target.value)}}})]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-danger",on:{click:function(e){return t.deleteName(r)}}},[t._v("删除")])])])])])})),n("div",{staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label"}),n("div",{staticClass:"field-body"},[n("button",{staticClass:"button is-link",on:{click:t.addName}},[t._v("添加名字")])])]),n("hr"),n("div",{staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label is-normal"},[n("label",{staticClass:"label"},[t._v("记录类型")]),"group"===t.editing.type?n("p",{staticClass:"help"},[t._v("请为每个社团成员创建单独的文件，不要把成员的账号放进社团的文件")]):t._e()]),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field"},[n("div",{staticClass:"select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.editing.type,expression:"editing.type"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.editing,"type",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"vtuber"}},[t._v("虚拟主播")]),n("option",{attrs:{value:"group"}},[t._v("社团")])])])])])]),n("div",{staticClass:"field is-horizontal"},[t._m(2),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field"},[n("label",{staticClass:"checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editing.bot,expression:"editing.bot"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.editing.bot)?t._i(t.editing.bot,null)>-1:t.editing.bot},on:{change:function(e){var n=t.editing.bot,r=e.target,a=!!r.checked;if(Array.isArray(n)){var i=null,s=t._i(n,i);r.checked?s<0&&t.$set(t.editing,"bot",n.concat([i])):s>-1&&t.$set(t.editing,"bot",n.slice(0,s).concat(n.slice(s+1)))}else t.$set(t.editing,"bot",a)}}}),t._v(" 机器人 ")])])])]),n("hr"),t._l(t.editing.accounts,(function(e,r){var a=e.id;e.platform,e.type;return n("div",{key:"account_"+r,staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label is-normal"},[r?t._e():n("label",{staticClass:"label"},[t._v("账号")]),a&&t.urls[r].startsWith("http")?n("a",{staticClass:"help url",attrs:{href:t.urls[r],target:"_blank"}},[t._v(t._s(t.urls[r]))]):n("p",{staticClass:"help url"},[t._v(t._s(t.urls[r]))])]),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field has-addons"},[n("div",{staticClass:"control"},[n("div",{staticClass:"select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.editing.accounts[r].platform,expression:"editing.accounts[n].platform"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.editing.accounts[r],"platform",e.target.multiple?n:n[0])}}},[t._l(t.platforms,(function(e){var a=e[0];return n("option",{key:"account_"+r+"_"+a,domProps:{value:a}},[t._v(t._s(a))])})),n("option",{attrs:{value:"other"}},[t._v("其他")])],2)])]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editing.accounts[r].id,expression:"editing.accounts[n].id"}],staticClass:"input",attrs:{type:"text",placeholder:"{id}"},domProps:{value:t.editing.accounts[r].id},on:{input:function(e){e.target.composing||t.$set(t.editing.accounts[r],"id",e.target.value)}}})]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-danger",on:{click:function(e){return t.deleteAccount(r)}}},[t._v("删除")])])])])])})),n("div",{staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label"}),n("div",{staticClass:"field-body"},[n("button",{staticClass:"button is-link",on:{click:t.addAccount}},[t._v("添加账号")])])]),n("hr"),n("div",{staticClass:"field is-horizontal"},[t._m(3),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field"},[n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editing.group,expression:"editing.group"}],staticClass:"input",attrs:{type:"text",placeholder:"社团"},domProps:{value:t.editing.group},on:{input:function(e){e.target.composing||t.$set(t.editing,"group",e.target.value)}}})]),t._l(t.groupAuto,(function(e){return n("button",{key:"groupAuto_"+e,staticClass:"button is-text",on:{click:function(n){t.editing.group=e}}},[t._v(t._s(e))])}))],2)])]),n("hr"),n("div",{staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label is-normal"},[t.saved?n("p",{staticClass:"help"},[t._v("保存成功!")]):t._e()]),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-link",class:{"is-loading":t.saving},attrs:{disabled:!t.editing.fileName||t.saving},on:{click:t.save}},[t._v("保存 "+t._s(t.fileName))])]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-link is-light",on:{click:t.reset}},[t._v("复原")])]),n("div",{staticClass:"control"},[n("router-link",{staticClass:"button is-light",attrs:{tag:"button",to:"/"}},[t._v("返回")])],1)])])]),n("hr"),n("code",[t._v(t._s(t.code))]),n("br")],2)},Ht=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-label is-normal"},[n("label",{staticClass:"label"},[t._v("文件名")]),n("p",{staticClass:"help"},[t._v("一般用名字")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"control"},[n("a",{staticClass:"button is-static"},[t._v(".json")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-label is-normal"},[n("label",{staticClass:"label"},[t._v("是不是机器人")]),n("p",{staticClass:"help"},[t._v("就是24*7那样的")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-label is-normal"},[n("label",{staticClass:"label"},[t._v("所属社团")]),n("p",{staticClass:"help"},[t._v("这里写所属社团记录的文件名"),n("br"),t._v("(不需要文件后缀)")]),n("p",{staticClass:"help"},[t._v("无所属留空")])])}],Qt=(n("a623"),n("5db7"),n("caad"),n("a434"),n("73d9"),n("8a79"),n("2532"),n("5319"),n("15fd")),Zt={props:["file"],data:function(){var t={fileName:"",names:[],type:"vtuber",bot:!1,accounts:[],group:""};return this.backup=JSON.stringify(t),this.blank=JSON.stringify(t),{editing:t,saving:!1,saved:!1,rest:{},groupList:[]}},watch:{editing:{deep:!0,handler:function(){this.saved=!1}},file:{immediate:!0,handler:function(t,e){var n=this;return Object(u["a"])(regeneratorRuntime.mark((function r(){var a,i,s,c,o,u,l,d,f;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t===e){r.next=19;break}if(!t){r.next=16;break}return n.editing.fileName=t.replace(".json",""),r.next=5,Object(F["getVtbJson"])(t);case 5:a=r.sent,i=a.accounts,s=void 0===i?{}:i,c=a.name,o=void 0===c?{}:c,u=a.type,l=a.bot,d=a.group,f=Object(Qt["a"])(a,["accounts","name","type","bot","group"]),Object.entries(o).flatMap((function(t){var e=Object(M["a"])(t,2),n=e[0],r=e[1];return[r].flat().map((function(t){return[n,t]}))})).forEach((function(t){var e=Object(M["a"])(t,2),r=e[0],a=e[1];return n.editing.names.push([r,a])})),Object.entries(s).flatMap((function(t){var e=Object(M["a"])(t,2),n=e[0],r=e[1];return[r].flat().map((function(t){return[n,t]}))})).map((function(t){var e=Object(M["a"])(t,2),n=e[0],r=e[1];return[n,r.id||r]})).forEach((function(t){var e=Object(M["a"])(t,2),r=e[0],a=e[1];return n.editing.accounts.push({platform:r,id:a})})),u&&(n.editing.type=u),l&&(n.editing.bot=l),d&&(n.editing.group=d),n.backup=JSON.stringify(n.editing),n.rest=f,r.next=19;break;case 16:n.backup=n.blank,n.rest={},n.reset();case 19:return r.next=21,Object(F["getGroupList"])();case 21:n.groupList=r.sent;case 22:case"end":return r.stop()}}),r)})))()}}},mounted:function(){return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])({},Object(c["c"])(["loadFileList"]),{addName:function(){this.editing.names.push(["",""])},deleteName:function(t){this.editing.names.splice(t,1)},addAccount:function(){this.editing.accounts.push({id:"",platform:"bilibili"})},deleteAccount:function(t){this.editing.accounts.splice(t,1)},save:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.saving=!0,!t.file){e.next=4;break}return e.next=4,Object(F["deleteVtb"])(t.file);case 4:return e.next=6,Object(F["saveVtb"])(t.fileName,t.data);case 6:return t.saving=!1,t.saved=!0,e.next=10,t.loadFileList();case 10:case"end":return e.stop()}}),e)})))()},reset:function(){this.editing=JSON.parse(this.backup)}}),computed:Object(s["a"])({},Object(c["d"])(["meta"]),{groupAuto:function(){var t=this.editing.group,e=t.toLowerCase().split(" ").filter(Boolean),n=this.groupList.filter((function(t){return e.every((function(e){return t.toLowerCase().includes(e)}))}));return 1===n.length&&n[0]===t?[]:n},platforms:function(){return Object.entries(this.meta.linkSyntax)},linkSyntax:function(){return Object(s["a"])({},this.meta.linkSyntax,{other:"请直接输入完整链接"})},urls:function(){var t=this;return this.editing.accounts.map((function(t){var e=t.platform,n=t.id;return{platform:e,id:n||"{id}"}})).map((function(e){var n=e.platform,r=e.id;return t.linkSyntax[n].replace("{id}",r)}))},fileName:function(){return"".concat(this.editing.fileName,".json")},code:function(){return JSON.stringify(this.data,void 0,2)},data:function(){var t={},e=this.editing,n=e.accounts,r=e.group,a=e.names,i=e.type,c=e.bot;return a.length&&(t.name={},a.forEach((function(e){var n=Object(M["a"])(e,2),r=n[0],a=n[1];t.name[r]?t.name[r]=[t.name[r],a].flat():t.name[r]=a}))),n.length&&(t.accounts={},n.forEach((function(e){var n=e.id,r=e.platform;t.accounts[r]?t.accounts[r]=[t.accounts[r],n].flat():t.accounts[r]=n}))),"vtuber"!==i&&(t.type=i),c&&(t.bot=!0),r&&(t.group=r,t.group.endsWith(".json")&&(t.group=t.group.replace(".json",""))),Object(s["a"])({},this.rest,{},t)}})},qt=Zt,Kt=(n("b647"),Object(x["a"])(qt,Vt,Ht,!1,null,"110a231c",null)),Yt=Kt.exports,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container high"},[n("br"),n("h1",{staticClass:"title"},[t._v("存档")]),n("h2",{staticClass:"subtitle"},[t._v("Workspace ("+t._s(t.workspaceCount)+")")]),n("hr"),n("div",{staticClass:"field has-addons"},[n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"input",attrs:{type:"text",placeholder:"名字"},domProps:{value:t.name},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save(e)},input:function(e){e.target.composing||(t.name=e.target.value)}}})]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-info",on:{click:t.save}},[t._v("保存")])])]),n("hr"),t._l(t.workspaceList,(function(e){return n("div",{key:"save_"+e,staticClass:"field is-horizontal"},[n("div",{staticClass:"field-label is-normal"},[n("label",{staticClass:"label"},[t._v(t._s(e))])]),n("div",{staticClass:"field-body"},[n("div",{staticClass:"field is-grouped"},[n("div",{staticClass:"control"},[n("button",{staticClass:"button is-info",on:{click:function(n){return t.load(e)}}},[t._v("载入")])]),n("div",{staticClass:"control"},[n("button",{staticClass:"button is-light is-danger",on:{click:function(n){return t.remove(e)}}},[t._v(" 删除")])])])])])})),n("br")],2)},te=[],ee={data:function(){return{workspaceListLoaded:!1,name:""}},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.loadWorkspaceList();case 2:t.workspaceListLoaded=!0;case 3:case"end":return e.stop()}}),e)})))()},computed:Object(s["a"])({workspaceCount:function(){return this.workspaceListLoaded?this.workspaceList.length:"loading..."}},Object(c["d"])(["workspaceList"])),methods:Object(s["a"])({},Object(c["c"])(["loadFileList","loadWorkspaceList"]),{save:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.name,!n){e.next=6;break}return e.next=4,Object(F["saveWorkspace"])(n);case 4:return e.next=6,t.loadWorkspaceList();case 6:case"end":return e.stop()}}),e)})))()},load:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(F["loadWorkspace"])(t);case 2:return n.next=4,e.loadFileList();case 4:case"end":return n.stop()}}),n)})))()},remove:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(F["deleteWorkspace"])(t);case 2:return n.next=4,e.loadWorkspaceList();case 4:case"end":return n.stop()}}),n)})))()}})},ne=ee,re=(n("fac2"),Object(x["a"])(ne,Xt,te,!1,null,"7f50a6a6",null)),ae=re.exports,ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"content"},[n("br"),t.username?n("status"):t.code||t.token?n("codee",{attrs:{code:t.code}}):n("login")],1)])},se=[],ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v("GitHub账号")]),n("img",{attrs:{src:t.extra.avatar,alt:"avatar",height:"128px",width:"128px"}}),n("p",[t._v("用户名: "+t._s(t.username)+" "),n("a",{attrs:{href:t.extra.url,target:"_blank"}},[t._v(t._s(t.extra.url))]),t._v(" "),n("br"),t._v(" 昵称: "+t._s(t.name)+" "),n("br"),t._v(" 邮箱: "+t._s(t.email))]),n("button",{staticClass:"button",on:{click:t.logout}},[t._v("登出")]),n("br")])},oe=[],ue=Object(c["a"])("login"),le=ue.mapState,de=ue.mapActions,fe={computed:le(["username","name","email","extra"]),methods:Object(s["a"])({},de(["updateToken"]),{logout:function(){this.updateToken()}})},pe=fe,me=Object(x["a"])(pe,ce,oe,!1,null,null,null),ve=me.exports,be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.fail||t.failed?n("p",[t._v("呜呜呜...登陆失败, 再试试吧QAQ")]):n("p",[t._v("登陆中...")]),t.fail||t.failed?n("login"):t._e()],1)},he=[],ge=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v("登陆GitHub")]),n("a",{attrs:{href:t.url}},[t._v("通过GitHub登陆")])])},je=[],_e={data:function(){return{url:p()}}},Oe=_e,ke=Object(x["a"])(Oe,ge,je,!1,null,null,null),xe=ke.exports,we=Object(c["a"])("login"),Ce=we.mapActions,ye=we.mapState,Le={props:["code"],components:{login:xe},data:function(){return{fail:!1}},computed:ye({failed:"fail"}),mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.code){e.next=10;break}return e.next=3,m(t.code).catch((function(){}));case 3:if(n=e.sent,!n){e.next=9;break}return e.next=7,t.updateToken(n);case 7:e.next=10;break;case 9:t.fail=!0;case 10:case"end":return e.stop()}}),e)})))()},methods:Ce(["updateToken"])},Re=Le,Ne=Object(x["a"])(Re,be,he,!1,null,null,null),Ee=Ne.exports,Se=Object(c["a"])("login"),Me=Se.mapState,$e={props:["code"],components:{login:xe,codee:Ee,status:ve},computed:Me(["username","token"])},Ae=$e,Fe=Object(x["a"])(Ae,ie,se,!1,null,null,null),Ie=Fe.exports;r["a"].use(y["a"]);var Pe=[{path:"/",component:rt},{path:"/submit",component:Ut},{path:"/edit",component:Yt},{path:"/edit/:file",component:Yt,props:!0},{path:"/workspace",component:ae},{path:"/login",component:Ie,props:function(t){return{code:t.query.code}}}],Te=new y["a"]({mode:"history",base:"/",routes:Pe}),We=Te;r["a"].use(c["b"]);var ze={namespaced:!0,state:{username:void 0,name:void 0,token:void 0,email:void 0,fail:!1,extra:{},commit:!0},getters:{currentState:function(t){return t.username?"(".concat(t.name||t.username,")"):t.fail?"(登陆失败)":t.token?"(登陆中)":""},command:function(t){if(t.commit&&t.username){var e=[["name",t.name||t.username]];return t.email&&e.push(["email",t.email]),e}return[]}},mutations:{setToken:function(t,e){t.token=e,b(e)},fail:function(t){t.fail=!0},setUsername:function(t,e){t.username=e},setName:function(t,e){t.name=e},setEmail:function(t,e){t.email=e},setExtra:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.extra=e},setCommit:function(t,e){t.commit=e}},actions:{updateToken:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){var r,a,i,s,c,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.commit,r("setToken",n),!n){t.next=14;break}return t.next=5,v(n).catch((function(){return{}}));case 5:a=t.sent,i=a.login,s=a.name,c=a.email,o=a.avatar,u=a.url,i?(r("setUsername",i),r("setExtra",{avatar:o,url:u}),s&&r("setName",s),c&&r("setEmail",c)):r("fail"),t.next=18;break;case 14:r("setUsername"),r("setExtra"),r("setName"),r("setEmail");case 18:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()}},Je=new c["b"].Store({state:{fileList:[],fsLoaded:!1,meta:{},diff:[],workspaceList:[]},mutations:{loadedFs:function(t){t.fsLoaded=!0},updateFileList:function(t,e){t.fileList=e},updateMeta:function(t,e){t.meta=e},updateDiff:function(t,e){t.diff=e},updateWorkspaceList:function(t,e){t.workspaceList=e}},actions:{loadFileList:function(t){return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.dispatch,e.next=3,Object(F["getList"])();case 3:return a=e.sent,n("updateFileList",a),e.next=7,r("loadDiff");case 7:case"end":return e.stop()}}),e)})))()},loadFs:function(t){return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,Object(F["loadFs"])();case 3:return e.t0=n,e.next=6,Object(F["getMeta"])();case 6:e.t1=e.sent,(0,e.t0)("updateMeta",e.t1),n("loadedFs");case 9:case"end":return e.stop()}}),e)})))()},loadDiff:function(t){return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.t0=n,e.next=4,Object(F["diff"])();case 4:e.t1=e.sent,(0,e.t0)("updateDiff",e.t1);case 6:case"end":return e.stop()}}),e)})))()},loadWorkspaceList:function(t){return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.t0=n,e.next=4,Object(F["loadWorkspaceList"])();case 4:e.t1=e.sent,(0,e.t0)("updateWorkspaceList",e.t1);case 6:case"end":return e.stop()}}),e)})))()}},modules:{login:ze}});n("e0d3");r["a"].config.productionTip=!1,new r["a"]({router:We,store:Je,render:function(t){return t(C)}}).$mount("#app")},"5d3d":function(t,e,n){},"61b8":function(t,e,n){},"61d0":function(t,e,n){},7284:function(t,e,n){"use strict";var r=n("3164"),a=n.n(r);a.a},8501:function(t,e,n){"use strict";var r=n("61d0"),a=n.n(r);a.a},"87c2":function(t,e,n){},"8a49":function(t,e,n){n("0481"),n("5db7"),n("4160"),n("d81d"),n("4069"),n("73d9"),n("b0c0"),n("4fad"),n("159b");var r=n("7037"),a=n("278c"),i=n("ded3"),s=n("e144"),c=s.v5;t.exports=function(t){var e=t.vtbs,n=t.linkSyntax,s=t.UUID_NAMESPACE;return{meta:{UUID_NAMESPACE:s,linkSyntax:n},vtbs:e.map((function(t){var e=t.name,n=t.object;return{uuid:c(e,s),object:n}})).map((function(t){var e=t.uuid,n=t.object;return{uuid:e,object:i({},n,{name:Object.entries(n.name||{})})}})).map((function(t){var e=t.uuid,n=t.object;return{uuid:e,object:i({},n,{accounts:Object.entries(n.accounts||{})})}})).map((function(t){var e=t.uuid,n=t.object,o={uuid:e};return o.type=n.type||"vtuber",o.bot=!!n.bot,o.accounts=n.accounts.map((function(t){var e=a(t,2),n=e[0],r=e[1];return[n,[r].flat()]})).flatMap((function(t){var e=a(t,2),n=e[0],r=e[1];return r.map((function(t){return{platform:n,id:t}}))})).map((function(t){var e=t.platform,n=t.id;return"string"===typeof n?{platform:e,id:{id:n}}:{platform:e,id:n}})).map((function(t){var e=t.platform,n=t.id;return i({},n,{type:n.type||"official",platform:e})})),o.name={extra:[]},n.name.map((function(t){var e=a(t,2),n=e[0],i=e[1];return"object"===r(i)?[n,i]:[n,[i]]})).forEach((function(t){var e=a(t,2),n=e[0],r=e[1];return r.forEach((function(t){o.name[n]?o.name.extra.push(t):o.name[n]=t}))})),!o.name.default&&(n.name[0]||[void 0])[0]&&(o.name.default=(n.name[0]||[void 0])[0]),n.group?o.group=c(n.group,s):"group"===o.type&&(o.group=e),o}))}}},9309:function(t,e,n){n("99af"),n("4160"),n("caad"),n("b0c0"),n("07ac"),n("2532"),n("159b");var r={};t.exports=function(t){var e=t.vtbs,n=[],a={},i=function(t){var e=t.platform,r=t.id,a=t.name;return function(t){return n.push("".concat(Object.values(a)[1],", ").concat(t,": ").concat(e,", ").concat(r))}};return e.forEach((function(t){var e=t.accounts,n=t.name;return e.forEach((function(t){var e=t.id,s=t.platform,c=(t.type,i({name:n,id:e,platform:s}));e||c("id为空"),a[s]||(a[s]={}),a[s][e]&&c("重复提交的账户, Duplicated"),a[s][e]=!0;var o=r[s]||[];o.includes(e)&&c("不能提交的账户, Never Submit")}))})),n}},a8cf:function(t,e,n){"use strict";var r=n("c76d"),a=n.n(r);a.a},adf3:function(t,e,n){"use strict";var r=n("87c2"),a=n.n(r);a.a},b647:function(t,e,n){"use strict";var r=n("263b"),a=n.n(r);a.a},b74b:function(t,e,n){n("99af"),n("4de4"),n("caad"),n("a15b"),n("d81d"),n("45fc"),n("ac1f"),n("2532"),n("1276");var r='\\/:*"<>|'.split("");t.exports=function(t,e){return e.filter((function(t){return r.some((function(e){return t.includes(e)}))})).map((function(t){return"非法文件名, illegal filename: ".concat(t,", should not contain ").concat(r.join(""))}))}},b90b:function(t,e,n){n("99af"),n("4de4"),n("5db7"),n("d81d"),n("73d9"),t.exports=function(t){var e=t.vtbs,n=t.meta.linkSyntax;return e.flatMap((function(t){var e=t.accounts;return e})).map((function(t){var e=t.id,r=t.platform;if(!n[r])return"不明平台, unknow platform, ".concat(r,", ").concat(e)})).filter(Boolean)}},c754:function(t,e,n){n("99af"),n("4de4"),n("5db7"),n("caad"),n("d81d"),n("73d9"),n("a9e3"),n("9129"),t.exports=function(t){var e=t.vtbs;return e.flatMap((function(t){var e=t.accounts;return e})).map((function(t){var e=t.id,n=t.platform;if(["bilibili","niconico","weibo"].includes(n)&&Number.isNaN(Number(e)))return"".concat(n," id: NaN, ").concat(e)})).filter(Boolean)}},c76d:function(t,e,n){},dd9f:function(t,e,n){"use strict";var r=n("0b01"),a=n.n(r);a.a},e0d3:function(t,e,n){},f3bb:function(t,e,n){"use strict";var r=n("61b8"),a=n.n(r);a.a},f89f:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"loadFs",(function(){return w})),n.d(e,"loadWorkspaceList",(function(){return C})),n.d(e,"saveWorkspace",(function(){return y})),n.d(e,"loadWorkspace",(function(){return L})),n.d(e,"deleteWorkspace",(function(){return R})),n.d(e,"getMeta",(function(){return N})),n.d(e,"getFs",(function(){return E})),n.d(e,"getList",(function(){return S})),n.d(e,"getGroupList",(function(){return M})),n.d(e,"searchList",(function(){return $})),n.d(e,"getVtbJson",(function(){return A})),n.d(e,"deleteVtb",(function(){return F})),n.d(e,"saveVtb",(function(){return I})),n.d(e,"resetVtb",(function(){return P})),n.d(e,"test",(function(){return W})),n.d(e,"diff",(function(){return J})),n.d(e,"serializeDiff",(function(){return G})),n.d(e,"makeIssue",(function(){return V})),n.d(e,"submitDiff",(function(){return H}));n("99af"),n("a623"),n("4de4"),n("0481"),n("5db7"),n("4160"),n("caad"),n("a15b"),n("d81d"),n("fb6a"),n("4069"),n("73d9"),n("4ec9"),n("4fad"),n("c1f9"),n("b64b"),n("d3b7"),n("ac1f"),n("25f0"),n("6062"),n("2532"),n("3ca3"),n("5319"),n("2ca0"),n("159b"),n("ddb0");var r,a,i,s,c=n("4f96"),o=n("2909"),u=n("5530"),l=n("3835"),d=(n("96cf"),n("1da1")),f=n("cf59"),p=n.n(f),m=n("0640"),v=n("8a49"),b=n.n(v),h=n("3e55"),g=n.n(h),j=p()("submit.vtbs.moe-workspace"),_=new Map,O=function(e){return t.from(e).toString("base64")},k=function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return t.abrupt("return",t.sent.json());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(i);return[t].flat().forEach((function(t){_.set(t,"".concat(t).concat(JSON.stringify(i[t]).toLowerCase()))}))},w=Object(m["c"])(Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k("https://vdb.vtbs.moe/json/fs.json");case 2:return a=t.sent,i||(i=JSON.parse(JSON.stringify(a)),s=Object.fromEntries(Object.keys(i).map((function(t){return[t.toLowerCase(),t]}))),x()),t.next=6,k("https://vdb.vtbs.moe/json/list.json");case 6:r=t.sent;case 7:case"end":return t.stop()}}),t)})))),C=Object(m["c"])((function(){return new Promise((function(t){var e=[];j.createKeyStream().on("data",(function(t){e.push(t)})).on("end",(function(){t(e)}))}))})),y=Object(m["c"])(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,j.put(e,JSON.stringify(i));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),L=Object(m["c"])(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,j.get(e);case 3:t.t1=t.sent,i=t.t0.parse.call(t.t0,t.t1),s=Object.fromEntries(Object.keys(i).map((function(t){return[t.toLowerCase(),t]}))),x();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),R=Object(m["c"])(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,j.del(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),N=Object(m["c"])((function(){return r.meta})),E=Object(m["c"])((function(){return i})),S=Object(m["c"])((function(){return Object.keys(i).reverse()})),M=Object(m["c"])((function(){return Object.entries(i).map((function(t){var e=Object(l["a"])(t,2),n=e[0],r=e[1].type;return{file:n,type:r}})).filter((function(t){var e=t.type;return"group"===e})).map((function(t){var e=t.file;return e.replace(".json","")}))})),$=Object(m["c"])((function(t){return S().map((function(t){return[t,_.get(t)]})).filter((function(e){var n=Object(l["a"])(e,2),r=(n[0],n[1]);return t.every((function(t){return r.includes(t)}))})).map((function(t){var e=Object(l["a"])(t,1),n=e[0];return n}))})),A=Object(m["c"])((function(t){return i[t]})),F=Object(m["c"])((function(t){delete i[t],delete s[t.toLowerCase()],_.delete(t)})),I=Object(m["c"])((function(t,e){var n=t.toLowerCase(),r=s[n];r&&F(r),i[t]=e,s[n]=t,x(t)})),P=Object(m["c"])((function(t){a[t]?I(t,JSON.parse(JSON.stringify(a[t]))):F(t)})),T=function(){return b()(Object(u["a"])({},r.meta,{vtbs:Object.entries(i).map((function(t){var e=Object(l["a"])(t,2),n=e[0],r=e[1];return[n.replace(".json",""),r]})).map((function(t){var e=Object(l["a"])(t,2),n=e[0],r=e[1];return{name:n,object:r}}))}))},W=Object(m["c"])((function(){return g()(T(),Object.keys(i))})),z=function(t){return i[t]?a[t]?JSON.stringify(a[t])!==JSON.stringify(i[t])?"update":void 0:"add":"remove"},J=Object(m["c"])((function(){return Object(o["a"])(new Set([].concat(Object(o["a"])(Object.keys(a)),Object(o["a"])(Object.keys(i))))).map((function(t){return[t,z(t)]})).filter((function(t){var e=Object(l["a"])(t,2),n=(e[0],e[1]);return n}))})),D=function(t){var e=i[t].accounts,n=void 0===e?{}:e,r=N(),a=r.linkSyntax;return Object.entries(n).map((function(t){var e=Object(l["a"])(t,2),n=e[0],r=e[1];return[a[n],r]})).map((function(t){return t.flat()})).map((function(t){var e=Object(c["a"])(t),n=e[0],r=e.slice(1);return[n,r.map((function(t){return t.id||t}))]})).flatMap((function(t){var e=Object(c["a"])(t),n=e[0],r=void 0===n?"{id}":n,a=e.slice(1);return a.map((function(t){return r.replace("{id}",t)}))}))},B=function(){var t=J();return t.map((function(t){var e=Object(l["a"])(t,2),n=e[0],r=e[1];if("add"===r||"update"===r){var a=D(n).map((function(t){return t.startsWith("http")?"<".concat(t,">"):t})).map((function(t){return"> ".concat(t)})).join("\n");if(a.length)return[n,r,"\n".concat(a,"\n")]}return[n,r]})).map((function(t){var e=Object(l["a"])(t,3),n=e[0],r=e[1],a=e[2],i=void 0===a?"":a;return"".concat(r,": ").concat(n).concat(i)})).sort().join("\n")},G=Object(m["c"])((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=J(),n=e.map((function(t){var e=Object(l["a"])(t,2),n=e[0],r=e[1];switch(r){case"remove":return["delete",n];case"add":case"update":return["put",n,JSON.stringify(A(n),void 0,2)];default:}})).filter(Boolean);return n.length?[].concat(Object(o["a"])(t),Object(o["a"])(n)):[]})),U=function(t){var e=G(t);return O(e.map((function(t){var e=Object(l["a"])(t,3),n=e[0],r=e[1],a=e[2],i=[n,O(r)];return a&&i.push(O(a)),i})).map((function(t){return t.join(":")})).join("\n"))},V=Object(m["c"])((function(t,e){var n=U(e),r=B();return"".concat(t,"\n\n### description\n\n").concat(r,"\n\n```\n-----BEGIN SUBMIT BLOCK-----").concat(n,"-----END SUBMIT BLOCK-----\n```\n\nSubmit from <https://submit.vtbs.moe>, please evaluate the automatic Pull Request")})),H=Object(m["c"])(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e,n,r){var a,i,s,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=V(e,n),i=r?"token ".concat(r):"Basic ZGQtY2VudGVyLWJvdDpkZDBiMmY0MjE4OThmNjAzZGYwNGM0NzdkMzQyNmU5MzE4MWRlZTUy",console.log({Authorization:i}),t.next=5,fetch("https://api.github.com/repos/dd-center/vdb/issues",{method:"POST",headers:{"Content-Type":"application/json",Authorization:i},body:JSON.stringify({title:"Change requested from submit.vtbs.moe",body:a})});case 5:return s=t.sent,t.next=8,s.json();case 8:return c=t.sent,o=c.html_url,t.abrupt("return",o);case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}())}.call(this,n("1c35").Buffer)},fac2:function(t,e,n){"use strict";var r=n("5d3d"),a=n.n(r);a.a}});
//# sourceMappingURL=app.0177a34b.js.map